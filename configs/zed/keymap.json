// Zed keymap
//
// For information on binding keys, see the Zed
// documentation: https://zed.dev/docs/key-bindings
//
// To see the default key bindings run `zed: open default keymap`
// from the command palette.
[
  // ── Code Actions Navigation ─────────────────────
  {
    "context": "showing_code_actions",
    "bindings": {
      "j": "editor::ContextMenuNext",
      "k": "editor::ContextMenuPrevious"
    }
  },

  // ── Editor Navigation (Normal mode, Vim mode enabled, full mode) ────────────────
  {
    "context": "Editor && vim_mode != insert && mode == full",
    "bindings": {
      // Command palette and tab switching
      ";": "command_palette::Toggle",
      "space space": "tab_switcher::ToggleAll",

      // Centered scrolling
      "ctrl-shift-u": "vim::ScrollUp",
      "ctrl-shift-d": "vim::ScrollDown",
      "ctrl-u": ["workspace::SendKeystrokes", "ctrl-shift-u z z"],
      "ctrl-d": ["workspace::SendKeystrokes", "ctrl-shift-d z z"],

      // Centered search next
      "ctrl-shift-n": "vim::MoveToNextMatch",
      "n": ["workspace::SendKeystrokes", "ctrl-shift-n z z"],

      // Convenience shortcuts
      "space f m": "editor::Format",
      "space s f": "file_finder::Toggle",
      "space s g": "project_search::ToggleFocus",
      "space c a": "editor::ToggleCodeActions",
      "space d b": "debugger::Start",
      "space s n": "zed::OpenSettings",
      "space t": "project_panel::ToggleFocus",
      "space g g": "git_panel::ToggleFocus",
      "space r": "task::Spawn",

      // Rename and tabs
      "f2": "editor::Rename",
      "alt-k": "vim::GoToTab",
      "alt-j": "vim::GoToPreviousTab",

      // Tab switcher
      "ctrl-w": "tab_switcher::CloseSelectedItem",

      // Multiple selections
      "down": "editor::AddSelectionBelow",
      "up": "editor::AddSelectionAbove",

      // Panel toggles and focuses
      "ctrl-h": "project_panel::ToggleFocus",
      "ctrl-j": "terminal_panel::ToggleFocus",

      // Disabled / unbound keys
      "ctrl-k": null,
      "ctrl-k ctrl-h": null,
      "ctrl-k ctrl-j": null,
      "ctrl-k ctrl-k": null,
      "ctrl-k ctrl-l": null,
      "ctrl-l": null
    }
  },

  // ── Empty Pane bindings ───────────────
  {
    "context": "EmptyPane",
    "bindings": {
      "space": null,
      "space t": "project_panel::ToggleFocus",
      "space g g": "git_panel::ToggleFocus",
      "ctrl-l": "editor::ToggleFocus"
    }
  },

  // ── Explorer Panel (Project Panel when not editing) ───────────────
  {
    "context": "(ProjectPanel && not_editing)",
    "bindings": {
      "space": null,
      "space t": "workspace::ToggleLeftDock",
      "space g g": "git_panel::ToggleFocus",
      "ctrl-l": "editor::ToggleFocus"
    }
  },

  // ── Git Panel (Changes List) ───────────────
  {
    "context": "(GitPanel && ChangesList)",
    "bindings": {
      "space": null,
      "space t": "project_panel::ToggleFocus",
      "space g g": "workspace::ToggleLeftDock",
      "ctrl-l": "editor::ToggleFocus"
    }
  },

  // ── Insert mode convenience (Vim insert mode) ──────────────────────
  {
    "context": "Editor && vim_mode == insert && !VimWaiting && !menu",
    "bindings": {
      "j k": "vim::NormalBefore"
    }
  },

  // ── Normal mode workspace bindings ───────────────
  {
    "context": "Workspace",
    "bindings": {
      "ctrl-alt-t": "workspace::NewTerminal"
    }
  },

  // ── Terminal and Debug Panel focus ───────────────────────────────
  {
    "context": "Terminal || DebugPanel",
    "bindings": {
      "ctrl-w": "pane::CloseActiveItem",
      "ctrl-k": "editor::ToggleFocus"
    }
  }
]
